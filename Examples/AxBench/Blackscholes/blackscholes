  inv_sqrt_2xPI = 0.39894228040143270286;
  rv= 1.0;
  create_array(otype,100);
  create_array(sptprice,100);
  create_array(strike,100);
  create_array(rate,100);
  create_array(volatility,100);
  create_array(otime,100);
  create_array(prices,100);
  numOptions = 100.0;
  strike[0] = 0.333333;
  sptprice[0] = 0.350000;
  rate[0] = 0.100000;
  volatility[0] = 0.200000;
  otime[0] = 0.500000;
  otype[0] = 0;
  strike[1] = 0.333333;
  sptprice[1] = 0.350000;
  rate[1] = 0.100000;
  volatility[1] = 0.200000;
  otime[1] = 0.500000;
  otype[1] = 1;
  strike[2] = 0.833333;
  sptprice[2] = 0.833333;
  rate[2] = 0.050000;
  volatility[2] = 0.150000;
  otime[2] = 1.000000;
  otype[2] = 1;
  strike[3] = 0.833333;
  sptprice[3] = 0.833333;
  rate[3] = 0.050000;
  volatility[3] = 0.150000;
  otime[3] = 1.000000;
  otype[3] = 0;
  strike[4] = 0.541667;
  sptprice[4] = 0.500000;
  rate[4] = 0.080000;
  volatility[4] = 0.300000;
  otime[4] = 0.250000;
  otype[4] = 0;
  strike[5] = 0.750000;
  sptprice[5] = 0.833333;
  rate[5] = 0.100000;
  volatility[5] = 0.100000;
  otime[5] = 0.100000;
  otype[5] = 0;
  strike[6] = 0.750000;
  sptprice[6] = 0.833333;
  rate[6] = 0.100000;
  volatility[6] = 0.100000;
  otime[6] = 0.500000;
  otype[6] = 0;
  strike[7] = 0.750000;
  sptprice[7] = 0.833333;
  rate[7] = 0.100000;
  volatility[7] = 0.100000;
  otime[7] = 1.000000;
  otype[7] = 0;
  strike[8] = 0.833333;
  sptprice[8] = 0.833333;
  rate[8] = 0.100000;
  volatility[8] = 0.100000;
  otime[8] = 0.100000;
  otype[8] = 0;
  strike[9] = 0.833333;
  sptprice[9] = 0.833333;
  rate[9] = 0.100000;
  volatility[9] = 0.100000;
  otime[9] = 0.500000;
  otype[9] = 0;
  strike[10] = 0.833333;
  sptprice[10] = 0.833333;
  rate[10] = 0.100000;
  volatility[10] = 0.100000;
  otime[10] = 1.000000;
  otype[10] = 0;
  strike[11] = 0.916667;
  sptprice[11] = 0.833333;
  rate[11] = 0.100000;
  volatility[11] = 0.100000;
  otime[11] = 0.100000;
  otype[11] = 0;
  strike[12] = 0.916667;
  sptprice[12] = 0.833333;
  rate[12] = 0.100000;
  volatility[12] = 0.100000;
  otime[12] = 0.500000;
  otype[12] = 0;
  strike[13] = 0.916667;
  sptprice[13] = 0.833333;
  rate[13] = 0.100000;
  volatility[13] = 0.100000;
  otime[13] = 1.000000;
  otype[13] = 0;
  strike[14] = 0.750000;
  sptprice[14] = 0.833333;
  rate[14] = 0.100000;
  volatility[14] = 0.250000;
  otime[14] = 0.100000;
  otype[14] = 0;
  strike[15] = 0.750000;
  sptprice[15] = 0.833333;
  rate[15] = 0.100000;
  volatility[15] = 0.250000;
  otime[15] = 0.500000;
  otype[15] = 0;
  strike[16] = 0.750000;
  sptprice[16] = 0.833333;
  rate[16] = 0.100000;
  volatility[16] = 0.250000;
  otime[16] = 1.000000;
  otype[16] = 0;
  strike[17] = 0.833333;
  sptprice[17] = 0.833333;
  rate[17] = 0.100000;
  volatility[17] = 0.250000;
  otime[17] = 0.100000;
  otype[17] = 0;
  strike[18] = 0.833333;
  sptprice[18] = 0.833333;
  rate[18] = 0.100000;
  volatility[18] = 0.250000;
  otime[18] = 0.500000;
  otype[18] = 0;
  strike[19] = 0.833333;
  sptprice[19] = 0.833333;
  rate[19] = 0.100000;
  volatility[19] = 0.250000;
  otime[19] = 1.000000;
  otype[19] = 0;
  strike[20] = 0.916667;
  sptprice[20] = 0.833333;
  rate[20] = 0.100000;
  volatility[20] = 0.250000;
  otime[20] = 0.100000;
  otype[20] = 0;
  strike[21] = 0.916667;
  sptprice[21] = 0.833333;
  rate[21] = 0.100000;
  volatility[21] = 0.250000;
  otime[21] = 0.500000;
  otype[21] = 0;
  strike[22] = 0.916667;
  sptprice[22] = 0.833333;
  rate[22] = 0.100000;
  volatility[22] = 0.250000;
  otime[22] = 1.000000;
  otype[22] = 0;
  strike[23] = 0.750000;
  sptprice[23] = 0.833333;
  rate[23] = 0.100000;
  volatility[23] = 0.500000;
  otime[23] = 0.100000;
  otype[23] = 0;
  strike[24] = 0.750000;
  sptprice[24] = 0.833333;
  rate[24] = 0.100000;
  volatility[24] = 0.500000;
  otime[24] = 0.500000;
  otype[24] = 0;
  strike[25] = 0.750000;
  sptprice[25] = 0.833333;
  rate[25] = 0.100000;
  volatility[25] = 0.500000;
  otime[25] = 1.000000;
  otype[25] = 0;
  strike[26] = 0.833333;
  sptprice[26] = 0.833333;
  rate[26] = 0.100000;
  volatility[26] = 0.500000;
  otime[26] = 0.100000;
  otype[26] = 0;
  strike[27] = 0.833333;
  sptprice[27] = 0.833333;
  rate[27] = 0.100000;
  volatility[27] = 0.500000;
  otime[27] = 0.500000;
  otype[27] = 0;
  strike[28] = 0.833333;
  sptprice[28] = 0.833333;
  rate[28] = 0.100000;
  volatility[28] = 0.500000;
  otime[28] = 1.000000;
  otype[28] = 0;
  strike[29] = 0.916667;
  sptprice[29] = 0.833333;
  rate[29] = 0.100000;
  volatility[29] = 0.500000;
  otime[29] = 0.100000;
  otype[29] = 0;
  strike[30] = 0.916667;
  sptprice[30] = 0.833333;
  rate[30] = 0.100000;
  volatility[30] = 0.500000;
  otime[30] = 0.500000;
  otype[30] = 0;
  strike[31] = 0.916667;
  sptprice[31] = 0.833333;
  rate[31] = 0.100000;
  volatility[31] = 0.500000;
  otime[31] = 1.000000;
  otype[31] = 0;
  strike[32] = 0.750000;
  sptprice[32] = 0.833333;
  rate[32] = 0.100000;
  volatility[32] = 0.100000;
  otime[32] = 0.100000;
  otype[32] = 1;
  strike[33] = 0.750000;
  sptprice[33] = 0.833333;
  rate[33] = 0.100000;
  volatility[33] = 0.100000;
  otime[33] = 0.500000;
  otype[33] = 1;
  strike[34] = 0.750000;
  sptprice[34] = 0.833333;
  rate[34] = 0.100000;
  volatility[34] = 0.100000;
  otime[34] = 1.000000;
  otype[34] = 1;
  strike[35] = 0.833333;
  sptprice[35] = 0.833333;
  rate[35] = 0.100000;
  volatility[35] = 0.100000;
  otime[35] = 0.100000;
  otype[35] = 1;
  strike[36] = 0.833333;
  sptprice[36] = 0.833333;
  rate[36] = 0.100000;
  volatility[36] = 0.100000;
  otime[36] = 0.500000;
  otype[36] = 1;
  strike[37] = 0.833333;
  sptprice[37] = 0.833333;
  rate[37] = 0.100000;
  volatility[37] = 0.100000;
  otime[37] = 1.000000;
  otype[37] = 1;
  strike[38] = 0.916667;
  sptprice[38] = 0.833333;
  rate[38] = 0.100000;
  volatility[38] = 0.100000;
  otime[38] = 0.100000;
  otype[38] = 1;
  strike[39] = 0.916667;
  sptprice[39] = 0.833333;
  rate[39] = 0.100000;
  volatility[39] = 0.100000;
  otime[39] = 0.500000;
  otype[39] = 1;
  strike[40] = 0.916667;
  sptprice[40] = 0.833333;
  rate[40] = 0.100000;
  volatility[40] = 0.100000;
  otime[40] = 1.000000;
  otype[40] = 1;
  strike[41] = 0.750000;
  sptprice[41] = 0.833333;
  rate[41] = 0.100000;
  volatility[41] = 0.250000;
  otime[41] = 0.100000;
  otype[41] = 1;
  strike[42] = 0.750000;
  sptprice[42] = 0.833333;
  rate[42] = 0.100000;
  volatility[42] = 0.250000;
  otime[42] = 0.500000;
  otype[42] = 1;
  strike[43] = 0.750000;
  sptprice[43] = 0.833333;
  rate[43] = 0.100000;
  volatility[43] = 0.250000;
  otime[43] = 1.000000;
  otype[43] = 1;
  strike[44] = 0.833333;
  sptprice[44] = 0.833333;
  rate[44] = 0.100000;
  volatility[44] = 0.250000;
  otime[44] = 0.100000;
  otype[44] = 1;
  strike[45] = 0.833333;
  sptprice[45] = 0.833333;
  rate[45] = 0.100000;
  volatility[45] = 0.250000;
  otime[45] = 0.500000;
  otype[45] = 1;
  strike[46] = 0.833333;
  sptprice[46] = 0.833333;
  rate[46] = 0.100000;
  volatility[46] = 0.250000;
  otime[46] = 1.000000;
  otype[46] = 1;
  strike[47] = 0.916667;
  sptprice[47] = 0.833333;
  rate[47] = 0.100000;
  volatility[47] = 0.250000;
  otime[47] = 0.100000;
  otype[47] = 1;
  strike[48] = 0.916667;
  sptprice[48] = 0.833333;
  rate[48] = 0.100000;
  volatility[48] = 0.250000;
  otime[48] = 0.500000;
  otype[48] = 1;
  strike[49] = 0.916667;
  sptprice[49] = 0.833333;
  rate[49] = 0.100000;
  volatility[49] = 0.250000;
  otime[49] = 1.000000;
  otype[49] = 1;
  strike[50] = 0.750000;
  sptprice[50] = 0.833333;
  rate[50] = 0.100000;
  volatility[50] = 0.500000;
  otime[50] = 0.100000;
  otype[50] = 1;
  strike[51] = 0.750000;
  sptprice[51] = 0.833333;
  rate[51] = 0.100000;
  volatility[51] = 0.500000;
  otime[51] = 0.500000;
  otype[51] = 1;
  strike[52] = 0.750000;
  sptprice[52] = 0.833333;
  rate[52] = 0.100000;
  volatility[52] = 0.500000;
  otime[52] = 1.000000;
  otype[52] = 1;
  strike[53] = 0.833333;
  sptprice[53] = 0.833333;
  rate[53] = 0.100000;
  volatility[53] = 0.500000;
  otime[53] = 0.100000;
  otype[53] = 1;
  strike[54] = 0.833333;
  sptprice[54] = 0.833333;
  rate[54] = 0.100000;
  volatility[54] = 0.500000;
  otime[54] = 0.500000;
  otype[54] = 1;
  strike[55] = 0.833333;
  sptprice[55] = 0.833333;
  rate[55] = 0.100000;
  volatility[55] = 0.500000;
  otime[55] = 1.000000;
  otype[55] = 1;
  strike[56] = 0.916667;
  sptprice[56] = 0.833333;
  rate[56] = 0.100000;
  volatility[56] = 0.500000;
  otime[56] = 0.100000;
  otype[56] = 1;
  strike[57] = 0.916667;
  sptprice[57] = 0.833333;
  rate[57] = 0.100000;
  volatility[57] = 0.500000;
  otime[57] = 0.500000;
  otype[57] = 1;
  strike[58] = 0.916667;
  sptprice[58] = 0.833333;
  rate[58] = 0.100000;
  volatility[58] = 0.500000;
  otime[58] = 1.000000;
  otype[58] = 1;
  strike[59] = 0.343750;
  sptprice[59] = 0.416667;
  rate[59] = 0.100000;
  volatility[59] = 0.100000;
  otime[59] = 0.100000;
  otype[59] = 0;
  strike[60] = 0.343750;
  sptprice[60] = 0.416667;
  rate[60] = 0.100000;
  volatility[60] = 0.100000;
  otime[60] = 0.500000;
  otype[60] = 0;
  strike[61] = 0.343750;
  sptprice[61] = 0.416667;
  rate[61] = 0.100000;
  volatility[61] = 0.100000;
  otime[61] = 1.000000;
  otype[61] = 0;
  strike[62] = 0.416667;
  sptprice[62] = 0.416667;
  rate[62] = 0.100000;
  volatility[62] = 0.100000;
  otime[62] = 0.100000;
  otype[62] = 0;
  strike[63] = 0.416667;
  sptprice[63] = 0.416667;
  rate[63] = 0.100000;
  volatility[63] = 0.100000;
  otime[63] = 0.500000;
  otype[63] = 0;
  strike[64] = 0.416667;
  sptprice[64] = 0.416667;
  rate[64] = 0.100000;
  volatility[64] = 0.100000;
  otime[64] = 1.000000;
  otype[64] = 0;
  strike[65] = 0.506250;
  sptprice[65] = 0.416667;
  rate[65] = 0.100000;
  volatility[65] = 0.100000;
  otime[65] = 0.100000;
  otype[65] = 0;
  strike[66] = 0.506250;
  sptprice[66] = 0.416667;
  rate[66] = 0.100000;
  volatility[66] = 0.100000;
  otime[66] = 0.500000;
  otype[66] = 0;
  strike[67] = 0.506250;
  sptprice[67] = 0.416667;
  rate[67] = 0.100000;
  volatility[67] = 0.100000;
  otime[67] = 1.000000;
  otype[67] = 0;
  strike[68] = 0.343750;
  sptprice[68] = 0.416667;
  rate[68] = 0.100000;
  volatility[68] = 0.250000;
  otime[68] = 0.100000;
  otype[68] = 0;
  strike[69] = 0.343750;
  sptprice[69] = 0.416667;
  rate[69] = 0.100000;
  volatility[69] = 0.250000;
  otime[69] = 0.500000;
  otype[69] = 0;
  strike[70] = 0.343750;
  sptprice[70] = 0.416667;
  rate[70] = 0.100000;
  volatility[70] = 0.250000;
  otime[70] = 1.000000;
  otype[70] = 0;
  strike[71] = 0.416667;
  sptprice[71] = 0.416667;
  rate[71] = 0.100000;
  volatility[71] = 0.250000;
  otime[71] = 0.100000;
  otype[71] = 0;
  strike[72] = 0.416667;
  sptprice[72] = 0.416667;
  rate[72] = 0.100000;
  volatility[72] = 0.250000;
  otime[72] = 0.500000;
  otype[72] = 0;
  strike[73] = 0.416667;
  sptprice[73] = 0.416667;
  rate[73] = 0.100000;
  volatility[73] = 0.250000;
  otime[73] = 1.000000;
  otype[73] = 0;
  strike[74] = 0.506250;
  sptprice[74] = 0.416667;
  rate[74] = 0.100000;
  volatility[74] = 0.250000;
  otime[74] = 0.100000;
  otype[74] = 0;
  strike[75] = 0.506250;
  sptprice[75] = 0.416667;
  rate[75] = 0.100000;
  volatility[75] = 0.250000;
  otime[75] = 0.500000;
  otype[75] = 0;
  strike[76] = 0.506250;
  sptprice[76] = 0.416667;
  rate[76] = 0.100000;
  volatility[76] = 0.250000;
  otime[76] = 1.000000;
  otype[76] = 0;
  strike[77] = 0.343750;
  sptprice[77] = 0.416667;
  rate[77] = 0.100000;
  volatility[77] = 0.500000;
  otime[77] = 0.100000;
  otype[77] = 0;
  strike[78] = 0.343750;
  sptprice[78] = 0.416667;
  rate[78] = 0.100000;
  volatility[78] = 0.500000;
  otime[78] = 0.500000;
  otype[78] = 0;
  strike[79] = 0.343750;
  sptprice[79] = 0.416667;
  rate[79] = 0.100000;
  volatility[79] = 0.500000;
  otime[79] = 1.000000;
  otype[79] = 0;
  strike[80] = 0.416667;
  sptprice[80] = 0.416667;
  rate[80] = 0.100000;
  volatility[80] = 0.500000;
  otime[80] = 0.100000;
  otype[80] = 0;
  strike[81] = 0.416667;
  sptprice[81] = 0.416667;
  rate[81] = 0.100000;
  volatility[81] = 0.500000;
  otime[81] = 0.500000;
  otype[81] = 0;
  strike[82] = 0.416667;
  sptprice[82] = 0.416667;
  rate[82] = 0.100000;
  volatility[82] = 0.500000;
  otime[82] = 1.000000;
  otype[82] = 0;
  strike[83] = 0.506250;
  sptprice[83] = 0.416667;
  rate[83] = 0.100000;
  volatility[83] = 0.500000;
  otime[83] = 0.100000;
  otype[83] = 0;
  strike[84] = 0.506250;
  sptprice[84] = 0.416667;
  rate[84] = 0.100000;
  volatility[84] = 0.500000;
  otime[84] = 0.500000;
  otype[84] = 0;
  strike[85] = 0.506250;
  sptprice[85] = 0.416667;
  rate[85] = 0.100000;
  volatility[85] = 0.500000;
  otime[85] = 1.000000;
  otype[85] = 0;
  strike[86] = 0.343750;
  sptprice[86] = 0.416667;
  rate[86] = 0.100000;
  volatility[86] = 0.100000;
  otime[86] = 0.100000;
  otype[86] = 1;
  strike[87] = 0.343750;
  sptprice[87] = 0.416667;
  rate[87] = 0.100000;
  volatility[87] = 0.100000;
  otime[87] = 0.500000;
  otype[87] = 1;
  strike[88] = 0.343750;
  sptprice[88] = 0.416667;
  rate[88] = 0.100000;
  volatility[88] = 0.100000;
  otime[88] = 1.000000;
  otype[88] = 1;
  strike[89] = 0.416667;
  sptprice[89] = 0.416667;
  rate[89] = 0.100000;
  volatility[89] = 0.100000;
  otime[89] = 0.100000;
  otype[89] = 1;
  strike[90] = 0.416667;
  sptprice[90] = 0.416667;
  rate[90] = 0.100000;
  volatility[90] = 0.100000;
  otime[90] = 0.500000;
  otype[90] = 1;
  strike[91] = 0.416667;
  sptprice[91] = 0.416667;
  rate[91] = 0.100000;
  volatility[91] = 0.100000;
  otime[91] = 1.000000;
  otype[91] = 1;
  strike[92] = 0.506250;
  sptprice[92] = 0.416667;
  rate[92] = 0.100000;
  volatility[92] = 0.100000;
  otime[92] = 0.100000;
  otype[92] = 1;
  strike[93] = 0.506250;
  sptprice[93] = 0.416667;
  rate[93] = 0.100000;
  volatility[93] = 0.100000;
  otime[93] = 0.500000;
  otype[93] = 1;
  strike[94] = 0.506250;
  sptprice[94] = 0.416667;
  rate[94] = 0.100000;
  volatility[94] = 0.100000;
  otime[94] = 1.000000;
  otype[94] = 1;
  strike[95] = 0.343750;
  sptprice[95] = 0.416667;
  rate[95] = 0.100000;
  volatility[95] = 0.250000;
  otime[95] = 0.100000;
  otype[95] = 1;
  strike[96] = 0.343750;
  sptprice[96] = 0.416667;
  rate[96] = 0.100000;
  volatility[96] = 0.250000;
  otime[96] = 0.500000;
  otype[96] = 1;
  strike[97] = 0.343750;
  sptprice[97] = 0.416667;
  rate[97] = 0.100000;
  volatility[97] = 0.250000;
  otime[97] = 1.000000;
  otype[97] = 1;
  strike[98] = 0.416667;
  sptprice[98] = 0.416667;
  rate[98] = 0.100000;
  volatility[98] = 0.250000;
  otime[98] = 0.100000;
  otype[98] = 1;
  strike[99] = 0.416667;
  sptprice[99] = 0.416667;
  rate[99] = 0.100000;
  volatility[99] = 0.250000;
  otime[99] = 0.500000;
  otype[99] = 1;
  
  v_strike = numOptions;
  v_rate = v_strike + numOptions;
  v_volatility = v_rate + numOptions;
  v_otime = v_volatility + numOptions;
  start = 0.0;
  end = numOptions;
  price_orig = 0.0;
  i =0.0;
  create_array(dataIn,6);
for (i=start; i<end; i=i+1.0;) {
 	 dataIn[0]   = sptprice[i];
     dataIn[1]   = strike[i];
     dataIn[2]   = rate[i];
     dataIn[3]   = volatility[i];
     dataIn[4]   = otime[i];
     dataIn[5]   = otype[i];
   v_sptprice = sptprice[i];
   v_strike = strike[i];
   v_rate = rate[i];
   v_volatility = volatility[i];
   v_time =  otime[i]; 
   v_otype = otype[i];
   xRiskFreeRate = v_rate;
   xVolatility = v_volatility;
   xTime = v_time;
   xSqrtTime = sqrt(xTime);
   tmp = v_sptprice / v_strike;
   logValues = log(tmp);
   xLogTerm = logValues;
   xPowerTerm = xVolatility * xVolatility;
   xPowerTerm = xPowerTerm * 0.5;
   xD1 = xRiskFreeRate + xPowerTerm;
   xD1 = xD1 * xTime;
   xD1 = xD1 + xLogTerm;
   xDen = xVolatility * xSqrtTime;
   xD1 = xD1 / xDen;
   xD2 = xD1 -  xDen;
   d1 = xD1;
   d2 = xD2;
   InputX = d1;
    if (InputX < 0.0) {
        InputX = 0.0 -InputX;
        sign = 1;
    } else{ 
        sign = 0;
    };
  xInput = InputX;
     expValues = exp(-0.5 * InputX * InputX);
    xNPrimeofX = expValues;
    xNPrimeofX = xNPrimeofX * inv_sqrt_2xPI;
    xK2 = 0.2316419 * xInput;
    xK2 = 1.0 + xK2;
    xK2 = 1.0 / xK2;
    xK2_2 = xK2 * xK2;
    xK2_3 = xK2_2 * xK2;
    xK2_4 = xK2_3 * xK2;
    xK2_5 = xK2_4 * xK2;
    
    xLocal_1 = xK2 * 0.319381530;
    xLocal_2 = xK2_2 * (-0.356563782);
    xLocal_3 = xK2_3 * 1.781477937;
    xLocal_2 = xLocal_2 + xLocal_3;
    xLocal_3 = xK2_4 * (-1.821255978);
    xLocal_2 = xLocal_2 + xLocal_3;
    xLocal_3 = xK2_5 * 1.330274429;
    xLocal_2 = xLocal_2 + xLocal_3;
   xLocal_1 = xLocal_2 + xLocal_1;
    xLocal   = xLocal_1 * xNPrimeofX;
    xLocal   = 1.0 - xLocal;
    OutputX  = xLocal;    
    if (sign==1.0) {
        OutputX = 1.0 - OutputX;
    };
    NofXd1 =  OutputX;
    InputX = d2;
    if (InputX < 0.0) {
        InputX = 0.0-InputX;
        sign = 1;
    } else{ 
        sign = 0;
    };
    xInput = InputX;
    expValues = exp(-0.5 * InputX * InputX);
    xNPrimeofX = expValues;
    xNPrimeofX = xNPrimeofX * inv_sqrt_2xPI;
   xK2 = 0.2316419 * xInput;
    xK2 = 1.0 + xK2;
    xK2 = 1.0 / xK2;
    xK2_2 = xK2 * xK2;
    xK2_3 = xK2_2 * xK2;
    xK2_4 = xK2_3 * xK2;
    xK2_5 = xK2_4 * xK2;
    
    xLocal_1 = xK2 * 0.319381530;
    xLocal_2 = xK2_2 * (-0.356563782);
    xLocal_3 = xK2_3 * 1.781477937;
    xLocal_2 = xLocal_2 + xLocal_3;
    xLocal_3 = xK2_4 * (-1.821255978);
    xLocal_2 = xLocal_2 + xLocal_3;
    xLocal_3 = xK2_5 * 1.330274429;
    xLocal_2 = xLocal_2 + xLocal_3;
    xLocal_1 = xLocal_2 + xLocal_1;
    xLocal   = xLocal_1 * xNPrimeofX;
    xLocal   = 1.0 - xLocal;
    OutputX  = xLocal;    
    if (sign==1.0) {
        OutputX = 1.0 - OutputX;
    };
    NofXd2 =  OutputX;
    FutureValueX = v_strike * ( exp( 0.0-(v_rate)*(v_time) ) );        
    if (v_otype == 0.0) {            
        OptionPrice = (v_sptprice * NofXd1) - (FutureValueX * NofXd2);
        
    } else { 
        NegNofXd1 = (1.0 - NofXd1);
        NegNofXd2 = (1.0 - NofXd2);
        OptionPrice = (FutureValueX * NegNofXd2) - (v_sptprice * NegNofXd1);
    };
      price_orig = OptionPrice;
                
    prices[i] = price_orig;
    i = i + 1.0;
  };
   
 require_nsb(price_orig,40);

